var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,r=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&i(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&i(e,n,t[n]);return e},s=(e,a)=>t(e,n(a)),u=(e,t,n)=>new Promise(((a,o)=>{var l=e=>{try{r(n.next(e))}catch(t){o(t)}},i=e=>{try{r(n.throw(e))}catch(t){o(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,i);r((n=n.apply(e,t)).next())}));import{A as c,bN as d,r as p,k as m,u as f,o as g,am as h,S as v,bw as b,a0 as y,B as C,a1 as w,a5 as x,D as S,ao as A,aa as k,ad as R,J as P,a4 as O,bB as F,bO as B,aC as I,a6 as j,aB as U,aU as D,w as T,H as L,bP as M,_ as N,bQ as _,R as $,O as z,b0 as G,bR as E,a8 as W,t as H,K as V,ac as q,bL as J,bS as K,bq as X,$ as Q,bT as Y,bU as Z,P as ee,W as te,ap as ne,bA as ae,bV as oe,bC as le,a$ as ie,bW as re,bX as se,bD as ue,bE as ce,F as de,G as pe,b7 as me,bv as fe,a_ as ge,c as he,bY as ve,X as be}from"./vendor.84d2d683.js";import{u as ye}from"./useFormItem.75e32247.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import{p as Ce,ad as we,b as xe,h as Se,_ as Ae,i as ke,al as Re,aw as Pe,I as Oe,ax as Fe,a5 as Be,a as Ie,ai as je,z as Ue,f as De,at as Te,w as Le,ay as Me,ac as Ne,ae as _e,az as $e,aA as ze,v as Ge,x as Ee,aB as We,aj as He}from"./index.2956b203.js";/* empty css                */import{u as Ve,B as qe,a as Je,b as Ke}from"./index.a66a0969.js";/* empty css                */import{d as Xe}from"./download.eecfd47d.js";import{S as Qe}from"./index.8bcb94a9.js";import{C as Ye}from"./index.1350911d.js";var Ze=Ae(c({name:"ApiRadioGroup",components:{RadioGroup:d.Group,RadioButton:d.Button,Radio:d},props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:Ce.bool,resultField:Ce.string.def(""),labelField:Ce.string.def("label"),valueField:Ce.string.def("value"),immediate:Ce.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:t}){const n=p([]),a=p(!1),o=p(!0),l=p([]),i=we(),{t:s}=xe(),[c]=ye(e),d=m((()=>{const{labelField:t,valueField:a,numberToString:o}=e;return f(n).reduce(((e,n)=>{if(n){const l=n[a];e.push(r({label:n[t],value:o?`${l}`:l},g(n,[t,a])))}return e}),[])}));function y(){return u(this,null,(function*(){const t=e.api;if(t&&Se(t)){n.value=[];try{a.value=!0;const o=yield t(e.params);if(Array.isArray(o))return n.value=o,void C();e.resultField&&(n.value=b(o,e.resultField)||[]),C()}catch(o){}finally{a.value=!1}}}))}function C(){t("options-change",f(d))}return h((()=>{e.immediate&&y()})),v((()=>e.params),(()=>{!f(o)&&y()}),{deep:!0}),{state:c,getOptions:d,attrs:i,loading:a,t:s,handleChange:function(e,...t){l.value=t},props:e}}}),[["render",function(e,t,n,a,o,l){const i=y("RadioButton"),r=y("Radio"),s=y("RadioGroup");return C(),w(s,O(e.attrs,{value:e.state,"onUpdate:value":t[0]||(t[0]=t=>e.state=t),"button-style":"solid",onChange:e.handleChange}),{default:x((()=>[(C(!0),S(k,null,A(e.getOptions,(t=>(C(),S(k,{key:`${t.value}`},[e.props.isBtn?(C(),w(i,{key:0,value:t.value,disabled:t.disabled},{default:x((()=>[R(P(t.label),1)])),_:2},1032,["value","disabled"])):(C(),w(r,{key:1,value:t.value,disabled:t.disabled},{default:x((()=>[R(P(t.label),1)])),_:2},1032,["value","disabled"]))],64)))),128))])),_:1},16,["value","onChange"])}]]);var et=Ae(c({name:"RadioButtonGroup",components:{RadioGroup:d.Group,RadioButton:d.Button},props:{value:{type:[String,Number,Boolean]},options:{type:Array,default:()=>[]}},setup(e){const t=we(),[n]=ye(e);return{state:n,getOptions:m((()=>{const{options:t}=e;if(!t||0===(null==t?void 0:t.length))return[];return t.some((e=>ke(e)))?t.map((e=>({label:e,value:e}))):t})),attrs:t}}}),[["render",function(e,t,n,a,o,l){const i=y("RadioButton"),r=y("RadioGroup");return C(),w(r,O(e.attrs,{value:e.state,"onUpdate:value":t[0]||(t[0]=t=>e.state=t),"button-style":"solid"}),{default:x((()=>[(C(!0),S(k,null,A(e.getOptions,(e=>(C(),w(i,{key:`${e.value}`,value:e.value,disabled:e.disabled},{default:x((()=>[R(P(e.label),1)])),_:2},1032,["value","disabled"])))),128))])),_:1},16,["value"])}]]);var tt=Ae(c({name:"ApiSelect",components:{Select:F,LoadingOutlined:B},inheritAttrs:!1,props:{value:[Array,Object,String,Number],numberToString:Ce.bool,api:{type:Function,default:null},params:{type:Object,default:()=>({})},resultField:Ce.string.def(""),labelField:Ce.string.def("label"),valueField:Ce.string.def("value"),immediate:Ce.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:t}){const n=p([]),a=p(!1),o=p(!0),l=p([]),i=we(),{t:c}=xe(),[d]=ye(e,"value","change",l),y=m((()=>{const{labelField:t,valueField:a,numberToString:o}=e;return f(n).reduce(((e,n)=>{if(n){const l=n[a];e.push(s(r({},g(n,[t,a])),{label:n[t],value:o?`${l}`:l}))}return e}),[])}));function C(){return u(this,null,(function*(){const t=e.api;if(t&&Se(t)){n.value=[];try{a.value=!0;const o=yield t(e.params);if(Array.isArray(o))return n.value=o,void w();e.resultField&&(n.value=b(o,e.resultField)||[]),w()}catch(o){}finally{a.value=!1}}}))}function w(){t("options-change",f(y))}return h((()=>{e.immediate&&C()})),v((()=>e.params),(()=>{!f(o)&&C()}),{deep:!0}),{state:d,attrs:i,getOptions:y,loading:a,t:c,handleFetch:function(){return u(this,null,(function*(){!e.immediate&&f(o)&&(yield C(),o.value=!1)}))},handleChange:function(e,...t){l.value=t}}}}),[["render",function(e,t,n,a,o,l){const i=y("LoadingOutlined"),r=y("Select");return C(),w(r,O({onDropdownVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,options:e.getOptions,value:e.state,"onUpdate:value":t[0]||(t[0]=t=>e.state=t)}),I({_:2},[A(Object.keys(e.$slots),(t=>({name:t,fn:x((n=>[j(e.$slots,t,U(D(n||{})))]))}))),e.loading?{name:"suffixIcon",fn:x((()=>[T(i,{spin:""})]))}:void 0,e.loading?{name:"notFoundContent",fn:x((()=>[L("span",null,[T(i,{spin:"",class:"mr-1"}),R(" "+P(e.t("component.form.apiSelectNotFound")),1)])]))}:void 0]),1040,["onDropdownVisibleChange","onChange","options","value"])}]]);var nt=Ae(c({name:"ApiTreeSelect",components:{ATreeSelect:M,LoadingOutlined:B},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:Ce.string.def("")},emits:["options-change","change"],setup(e,{attrs:t,emit:n}){const a=p([]),o=p(!1),l=p(!1),i=m((()=>r(r({},e.api?{treeData:f(a)}:{}),t)));function s(){return u(this,null,(function*(){const{api:t}=e;if(!t||!Se(t))return;let i;l.value=!0,a.value=[];try{i=yield t(e.params)}catch(r){}l.value=!1,i&&(Re(i)||(i=b(i,e.resultField)),a.value=i||[],o.value=!0,n("options-change",a.value))}))}return v((()=>e.params),(()=>{!f(o)&&s()}),{deep:!0}),v((()=>e.immediate),(e=>{e&&!o.value&&s()})),N((()=>{e.immediate&&s()})),{getAttrs:i,loading:l,handleChange:function(...e){n("change",...e)}}}}),[["render",function(e,t,n,a,o,l){const i=y("LoadingOutlined"),r=y("a-tree-select");return C(),w(r,O(e.getAttrs,{onChange:e.handleChange}),I({_:2},[A(Object.keys(e.$slots),(t=>({name:t,fn:x((n=>[j(e.$slots,t,U(D(n||{})))]))}))),e.loading?{name:"suffixIcon",fn:x((()=>[T(i,{spin:""})]))}:void 0]),1040,["onChange"])}]]);var at=Ae(c({name:"ApiCascader",components:{LoadingOutlined:B,[_.name]:_},props:{value:{type:Array},api:{type:Function,default:null},numberToString:Ce.bool,resultField:Ce.string.def(""),labelField:Ce.string.def("label"),valueField:Ce.string.def("value"),childrenField:Ce.string.def("children"),asyncFetchParamKey:Ce.string.def("parentCode"),immediate:Ce.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(e,{emit:t}){const n=p([]),a=p([]),o=p(!1),l=p([]),i=p(!0),[c]=ye(e,"value","change",l);function d(t){const{labelField:n,valueField:a,numberToString:o,childrenField:l,isLeaf:i}=e;return t.reduce(((e,t)=>{if(t){const u=t[a],c=s(r({},g(t,[n,a])),{label:t[n],value:o?`${u}`:u,isLeaf:!(!i||"function"!=typeof i)&&i(t)}),p=Reflect.get(t,l);p&&Reflect.set(c,l,d(p)),e.push(c)}return e}),[])}function m(){return u(this,null,(function*(){const t=e.api;if(t&&Se(t)){n.value=[],o.value=!0;try{const a=yield t(e.initFetchParams);if(Array.isArray(a))return void(n.value=a);e.resultField&&(n.value=b(a,e.resultField)||[])}catch(a){}finally{o.value=!1}}}))}return v(n,(e=>{const t=d(e);a.value=t}),{deep:!0}),h((()=>{e.immediate&&m()})),v((()=>e.initFetchParams),(()=>{!f(i)&&m()}),{deep:!0}),{state:c,options:a,loading:o,handleChange:function(e,n){l.value=e,t("defaultChange",e,n)},loadData:function(t){return u(this,null,(function*(){const n=t[t.length-1];n.loading=!0;const a=e.api;if(a&&Se(a))try{const t=yield a({[e.asyncFetchParamKey]:Reflect.get(n,"value")});if(Array.isArray(t)){const e=d(t);return void(n.children=e)}if(e.resultField){const a=d(b(t,e.resultField)||[]);n.children=a}}catch(o){}finally{n.loading=!1}}))},handleRenderDisplay:function({labels:t,selectedOptions:n}){return f(l).length===n.length?t.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):""}}}}),[["render",function(e,t,n,a,o,l){const i=y("LoadingOutlined"),r=y("a-cascader");return C(),w(r,{value:e.state,"onUpdate:value":t[0]||(t[0]=t=>e.state=t),options:e.options,"load-data":e.loadData,"change-on-select":"",onChange:e.handleChange,displayRender:e.handleRenderDisplay},I({_:2},[e.loading?{name:"suffixIcon",fn:x((()=>[T(i,{spin:""})]))}:void 0,e.loading?{name:"notFoundContent",fn:x((()=>[L("span",null,[T(i,{spin:"",class:"mr-1"}),R(" "+P(e.t("component.form.apiSelectNotFound")),1)])]))}:void 0]),1032,["value","options","load-data","onChange","displayRender"])}]]);const{t:ot}=xe();var lt,it;(it=lt||(lt={})).SUCCESS="success",it.ERROR="error",it.UPLOADING="uploading";const rt={helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:Infinity},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:{}},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null}},st=s(r({value:{type:Array,default:()=>[]}},rt),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),ut={value:{type:Array,default:()=>[]}},ct={columns:{type:[Array],default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null}};function dt(e){return/\.(jpg|jpeg|png|gif)$/i.test(e)}const pt=Symbol("basic-table");function mt(e){$(pt,e)}function ft(){return z(pt)}const{table:gt}=Pe,{pageSizeOptions:ht,defaultPageSize:vt,fetchSetting:bt,defaultSize:yt,defaultSortFn:Ct,defaultFilterFn:wt}=gt,xt="key",St=ht,At=vt,kt=bt,Rt=yt,Pt=Ct,Ot=wt,Ft="center",Bt="INDEX",It="ACTION";var jt=Ae(c({name:"TableAction",components:{Icon:Oe,PopConfirmButton:Fe,Divider:G,Dropdown:Be,MoreOutlined:E,Tooltip:W},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:Ce.bool.def(!0),outside:Ce.bool,stopButtonPropagation:Ce.bool.def(!1)},setup(e){const{prefixCls:t}=Ie("basic-table-action");let n={};e.outside||(n=ft());const{hasPermission:a}=je();function o(e){const t=e.ifShow;let n=!0;return Ue(t)&&(n=t),Se(t)&&(n=t(e)),n}return{prefixCls:t,getActions:m((()=>(H(e.actions)||[]).filter((e=>a(e.auth)&&o(e))).map((e=>{const{popConfirm:t}=e;return s(r(r({getPopupContainer:()=>{var e;return null!=(e=f(null==n?void 0:n.wrapRef.value))?e:document.body},type:"link",size:"small"},e),t||{}),{onConfirm:null==t?void 0:t.confirm,onCancel:null==t?void 0:t.cancel,enable:!!t})})))),getDropdownList:m((()=>(H(e.dropDownActions)||[]).filter((e=>a(e.auth)&&o(e))).map(((t,n)=>{const{label:a,popConfirm:o}=t;return s(r(r({},t),o),{onConfirm:null==o?void 0:o.confirm,onCancel:null==o?void 0:o.cancel,text:a,divider:n<e.dropDownActions.length-1&&e.divider})})))),getAlign:m((()=>{var e,t;const a=((null==(e=null==n?void 0:n.getColumns)?void 0:e.call(n))||[]).find((e=>"ACTION"===e.flag));return null!=(t=null==a?void 0:a.align)?t:"left"})),onCellClick:function(t){if(!e.stopButtonPropagation)return;t.composedPath().find((e=>{var t;return"BUTTON"===(null==(t=e.tagName)?void 0:t.toUpperCase())}))&&t.stopPropagation()},getTooltip:function(e){return r({getPopupContainer:()=>{var e;return null!=(e=f(null==n?void 0:n.wrapRef.value))?e:document.body},placement:"bottom"},ke(e)?{title:e}:e)}}}}),[["render",function(e,t,n,a,o,l){const i=y("Icon"),r=y("PopConfirmButton"),s=y("Tooltip"),u=y("Divider"),c=y("MoreOutlined"),d=y("a-button"),p=y("Dropdown");return C(),S("div",{class:V([e.prefixCls,e.getAlign]),onClick:t[0]||(t[0]=(...t)=>e.onCellClick&&e.onCellClick(...t))},[(C(!0),S(k,null,A(e.getActions,((t,n)=>(C(),S(k,{key:`${n}-${t.label}`},[t.tooltip?(C(),w(s,U(O({key:0},e.getTooltip(t.tooltip))),{default:x((()=>[T(r,U(D(t)),{default:x((()=>[t.icon?(C(),w(i,{key:0,icon:t.icon,class:V({"mr-1":!!t.label})},null,8,["icon","class"])):q("",!0),t.label?(C(),S(k,{key:1},[R(P(t.label),1)],64)):q("",!0)])),_:2},1040)])),_:2},1040)):(C(),w(r,U(O({key:1},t)),{default:x((()=>[t.icon?(C(),w(i,{key:0,icon:t.icon,class:V({"mr-1":!!t.label})},null,8,["icon","class"])):q("",!0),t.label?(C(),S(k,{key:1},[R(P(t.label),1)],64)):q("",!0)])),_:2},1040)),e.divider&&n<e.getActions.length-1?(C(),w(u,{key:2,type:"vertical",class:"action-divider"})):q("",!0)],64)))),128)),e.dropDownActions&&e.getDropdownList.length>0?(C(),w(p,{key:0,trigger:["hover"],dropMenuList:e.getDropdownList,popconfirm:""},{default:x((()=>[j(e.$slots,"more"),e.$slots.more?q("",!0):(C(),w(d,{key:0,type:"link",size:"small"},{default:x((()=>[T(c,{class:"icon-more"})])),_:1}))])),_:3},8,["dropMenuList"])):q("",!0)],2)}]]);const Ut=c({components:{Image:J},props:{fileUrl:Ce.string.def(""),fileName:Ce.string.def("")}}),Dt={class:"thumb"};var Tt=Ae(Ut,[["render",function(e,t,n,a,o,l){const i=y("Image");return C(),S("span",Dt,[e.fileUrl?(C(),w(i,{key:0,src:e.fileUrl,width:104},null,8,["src"])):q("",!0)])}]]);const{t:Lt}=xe();function Mt(e){return{width:120,title:Lt("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:t})=>{const n=[{label:Lt("component.upload.del"),color:"error",onClick:e.bind(null,t)}];return T(jt,{actions:n,outside:!0},null)}}}function Nt({handleRemove:e,handleDownload:t}){return{width:160,title:Lt("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:n})=>{const a=[{label:Lt("component.upload.del"),color:"error",onClick:e.bind(null,n)},{label:Lt("component.upload.download"),onClick:t.bind(null,n)}];return T(jt,{actions:a,outside:!0},null)}}}const _t=[];for(let an=0;an<=15;an++)_t[an]=an.toString(16);function $t(){let e="";for(let t=1;t<=36;t++)e+=9===t||14===t||19===t||24===t?"-":15===t?4:20===t?_t[4*Math.random()|8]:_t[16*Math.random()|0];return e.replace(/-/g,"")}var zt=c({name:"FileList",props:ct,setup(e){const t=Ve();return v((()=>e.dataSource),(()=>{Q((()=>{var e;null==(e=null==t?void 0:t.redoModalHeight)||e.call(t)}))})),()=>{const{columns:t,actionColumn:n,dataSource:a}=e,o=[...t,n];return T("table",{class:"file-table"},[T("colgroup",null,[o.map((e=>{const{width:t=0,dataIndex:n}=e;return T("col",{style:t?{width:`${t}px`,minWidth:`${t}px`}:{},key:n},null)}))]),T("thead",null,[T("tr",{class:"file-table-tr"},[o.map((e=>{const{title:t="",align:n="center",dataIndex:a}=e;return T("th",{class:["file-table-th",n],key:a},[t])}))])]),T("tbody",null,[a.map(((e={},t)=>T("tr",{class:"file-table-tr",key:`${t+e.name||""}`},[o.map((t=>{const{dataIndex:n="",customRender:a,align:o="center"}=t,l=a&&Se(a);return T("td",{class:["file-table-td",o],key:n},[l?null==a?void 0:a({text:e[n],record:e}):e[n]])}))])))])])}}});const Gt=c({components:{BasicModal:qe,Upload:Y,Alert:Z,FileList:zt},props:s(r({},rt),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(e,{emit:t}){const n=ee({fileList:[]}),a=p(!1),o=p([]),{accept:l,helpText:i,maxNumber:s,maxSize:c}=te(e),{t:d}=xe(),[g,{closeModal:h}]=Je(),{getAccept:v,getStringAccept:b,getHelpText:y}=function({acceptRef:e,helpTextRef:t,maxNumberRef:n,maxSizeRef:a}){const o=m((()=>{const t=f(e);return t&&t.length>0?t:[]})),l=m((()=>f(o).map((e=>e.indexOf("/")>0||e.startsWith(".")?e:`.${e}`)).join(","))),i=m((()=>{const o=f(t);if(o)return o;const l=[],i=f(e);i.length>0&&l.push(ot("component.upload.accept",[i.join(",")]));const r=f(a);r&&l.push(ot("component.upload.maxSize",[r]));const s=f(n);return s&&Infinity!==s&&l.push(ot("component.upload.maxNumber",[s])),l.join("ï¼Œ")}));return{getAccept:o,getStringAccept:l,getHelpText:i}}({acceptRef:l,helpTextRef:i,maxNumberRef:s,maxSizeRef:c}),{createMessage:C}=De(),w=m((()=>o.value.length>0&&!o.value.every((e=>e.status===lt.SUCCESS)))),x=m((()=>{const e=o.value.some((e=>e.status===lt.SUCCESS));return{disabled:a.value||0===o.value.length||!e}})),S=m((()=>{const e=o.value.some((e=>e.status===lt.ERROR));return a.value?d("component.upload.uploading"):d(e?"component.upload.reUploadFailed":"component.upload.startUpload")}));return{columns:[{dataIndex:"thumbUrl",title:Lt("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:t}=e||{};return t&&T(Tt,{fileUrl:t},null)}},{dataIndex:"name",title:Lt("component.upload.fileName"),align:"left",customRender:({text:e,record:t})=>{const{percent:n,status:a}=t||{};let o="normal";return a===lt.ERROR?o="exception":a===lt.UPLOADING?o="active":a===lt.SUCCESS&&(o="success"),T("span",null,[T("p",{class:"truncate mb-1",title:e},[e]),T(K,{percent:n,size:"small",status:o},null)])}},{dataIndex:"size",title:Lt("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:Lt("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===lt.SUCCESS?T(X,{color:"green"},{default:()=>Lt("component.upload.uploadSuccess")}):e===lt.ERROR?T(X,{color:"red"},{default:()=>Lt("component.upload.uploadError")}):e===lt.UPLOADING?T(X,{color:"blue"},{default:()=>Lt("component.upload.uploading")}):e}],actionColumn:Mt((function(e){const n=o.value.findIndex((t=>t.uuid===e.uuid));-1!==n&&o.value.splice(n,1),t("delete",e)})),register:g,closeModal:h,getHelpText:y,getStringAccept:b,getOkButtonProps:x,beforeUpload:function(t){const{size:n,name:a}=t,{maxSize:l}=e,i=f(v);if(l&&t.size/1024/1024>=l)return C.error(d("component.upload.maxSizeMultiple",[l])),!1;if(i.length>0&&!function(e,t){const n=t.join("|");return new RegExp("\\.("+n+")$","i").test(e.name)}(t,i))return C.error(d("component.upload.acceptUpload",[i.join(",")])),!1;const s={uuid:$t(),file:t,size:n,name:a,percent:0,type:a.split(".").pop()};return!function(e){return dt(e.name)}(t)?o.value=[...f(o),s]:function(e){return new Promise(((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t({result:a.result,file:e}),a.onerror=e=>n(e)}))}(t).then((({result:e})=>{o.value=[...f(o),r({thumbUrl:e},s)]})),!1},fileListRef:o,state:n,isUploadingRef:a,handleStartUpload:function(){return u(this,null,(function*(){var t;const{maxNumber:n}=e;if(o.value.length+(null==(t=e.previewFileList)?void 0:t.length)>n)return C.warning(d("component.upload.maxNumber",[n]));try{a.value=!0;const t=o.value.filter((e=>e.status!==lt.SUCCESS))||[],n=yield Promise.all(t.map((t=>function(t){return u(this,null,(function*(){var n;const{api:a}=e;if(!a||!Se(a))return Te("upload api must exist and be a function");try{t.status=lt.UPLOADING;const{data:a}=yield null==(n=e.api)?void 0:n.call(e,{data:r({},e.uploadParams||{}),file:t.file,name:e.name,filename:e.filename},(function(e){const n=e.loaded/e.total*100|0;t.percent=n}));return t.status=lt.SUCCESS,t.responseData=a,{success:!0,error:null}}catch(o){return t.status=lt.ERROR,{success:!1,error:o}}}))}(t))));a.value=!1;const l=n.filter((e=>!e.success));if(l.length>0)throw l}catch(l){throw a.value=!1,l}}))},handleOk:function(){const{maxNumber:n}=e;if(o.value.length>n)return C.warning(d("component.upload.maxNumber",[n]));if(a.value)return C.warning(d("component.upload.saveWarn"));const l=[];for(const e of o.value){const{status:t,responseData:n}=e;t===lt.SUCCESS&&n&&l.push(n.url)}if(l.length<=0)return C.warning(d("component.upload.saveError"));o.value=[],h(),t("change",l)},handleCloseFunc:function(){return u(this,null,(function*(){return a.value?(C.warning(d("component.upload.uploadWait")),!1):(o.value=[],!0)}))},getIsSelectFile:w,getUploadBtnText:S,t:d}}}),Et={class:"upload-modal-toolbar"};var Wt=Ae(Gt,[["render",function(e,t,n,a,o,l){const i=y("a-button"),r=y("Alert"),s=y("Upload"),u=y("FileList"),c=y("BasicModal");return C(),w(c,O({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,wrapClassName:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:x((()=>[T(i,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:x((()=>[R(P(e.getUploadBtnText),1)])),_:1},8,["onClick","disabled","loading"])])),default:x((()=>[L("div",Et,[T(r,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),T(s,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,class:"upload-modal-toolbar__btn"},{default:x((()=>[T(i,{type:"primary"},{default:x((()=>[R(P(e.t("component.upload.choose")),1)])),_:1})])),_:1},8,["accept","multiple","before-upload"])]),T(u,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])])),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])}]]);const Ht=c({components:{BasicModal:qe,FileList:zt},props:ut,emits:["list-change","register","delete"],setup(e,{emit:t}){const[n,{closeModal:a}]=Je(),{t:o}=xe(),l=p([]);return v((()=>e.value),(e=>{Re(e)||(e=[]),l.value=e.filter((e=>!!e)).map((e=>({url:e,type:e.split(".").pop()||"",name:e.split("/").pop()||""})))}),{immediate:!0}),{t:o,register:n,closeModal:a,fileListRef:l,columns:[{dataIndex:"url",title:Lt("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:t}=e||{};return dt(t)&&T(Tt,{fileUrl:t},null)}},{dataIndex:"name",title:Lt("component.upload.fileName"),align:"left"}],actionColumn:Nt({handleRemove:function(e){const n=l.value.findIndex((t=>t.url===e.url));if(-1!==n){const e=l.value.splice(n,1);t("delete",e[0].url),t("list-change",l.value.map((e=>e.url)))}},handleDownload:function(e){const{url:t=""}=e;Xe({url:t})}})}}});const Vt=Le(Ae(c({name:"BasicUpload",components:{UploadModal:Wt,UploadPreviewModal:Ae(Ht,[["render",function(e,t,n,a,o,l){const i=y("FileList"),r=y("BasicModal");return C(),w(r,O({width:"800px",title:e.t("component.upload.preview"),wrapClassName:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:x((()=>[T(i,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])])),_:1},16,["title","onRegister"])}]]),Icon:Oe,Tooltip:W},props:st,emits:["change","delete","preview-delete","update:value"],setup(e,{emit:t,attrs:n}){const{t:a}=xe(),[o,{openModal:l}]=Ke(),[i,{openModal:s}]=Ke(),u=p([]),c=m((()=>{const{emptyHidePreview:t}=e;return!t||(!t||u.value.length>0)})),d=m((()=>{const t=r(r({},n),e);return g(t,"onChange")}));return v((()=>e.value),((e=[])=>{u.value=Re(e)?e:[]}),{immediate:!0}),{registerUploadModal:o,openUploadModal:l,handleChange:function(e){u.value=[...f(u),...e||[]],t("update:value",u.value),t("change",u.value)},handlePreviewChange:function(e){u.value=[...e||[]],t("update:value",u.value),t("change",u.value)},registerPreviewModal:i,openPreviewModal:s,fileList:u,showPreview:c,bindValue:d,handleDelete:function(e){t("delete",e)},handlePreviewDelete:function(e){t("preview-delete",e)},t:a}}}),[["render",function(e,t,n,a,o,l){const i=y("a-button"),r=y("Icon"),s=y("Tooltip"),u=y("a-button-group"),c=y("UploadModal"),d=y("UploadPreviewModal");return C(),S("div",null,[T(u,null,{default:x((()=>[T(i,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:x((()=>[R(P(e.t("component.upload.upload")),1)])),_:1},8,["onClick"]),e.showPreview?(C(),w(s,{key:0,placement:"bottom"},{title:x((()=>[R(P(e.t("component.upload.uploaded"))+" ",1),e.fileList.length?(C(),S(k,{key:0},[R(P(e.fileList.length),1)],64)):q("",!0)])),default:x((()=>[T(i,{onClick:e.openPreviewModal},{default:x((()=>[T(r,{icon:"bi:eye"}),e.fileList.length&&e.showPreviewNumber?(C(),S(k,{key:0},[R(P(e.fileList.length),1)],64)):q("",!0)])),_:1},8,["onClick"])])),_:1})):q("",!0)])),_:1}),T(c,O(e.bindValue,{previewFileList:e.fileList,onRegister:e.registerUploadModal,onChange:e.handleChange,onDelete:e.handleDelete}),null,16,["previewFileList","onRegister","onChange","onDelete"]),T(d,{value:e.fileList,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange,onDelete:e.handlePreviewDelete},null,8,["value","onRegister","onListChange","onDelete"])])}]])),qt=new Map;qt.set("Input",ne),qt.set("InputGroup",ne.Group),qt.set("InputPassword",ne.Password),qt.set("InputSearch",ne.Search),qt.set("InputTextArea",ne.TextArea),qt.set("InputNumber",ae),qt.set("AutoComplete",oe),qt.set("Select",F),qt.set("ApiSelect",tt),qt.set("TreeSelect",M),qt.set("ApiTreeSelect",nt),qt.set("ApiRadioGroup",Ze),qt.set("Switch",le),qt.set("RadioButtonGroup",et),qt.set("RadioGroup",d.Group),qt.set("Checkbox",ie),qt.set("CheckboxGroup",ie.Group),qt.set("ApiCascader",at),qt.set("Cascader",_),qt.set("Slider",re),qt.set("Rate",se),qt.set("DatePicker",ue),qt.set("MonthPicker",ue.MonthPicker),qt.set("RangePicker",ue.RangePicker),qt.set("WeekPicker",ue.WeekPicker),qt.set("TimePicker",ce),qt.set("StrengthMeter",Qe),qt.set("IconPicker",Me),qt.set("InputCountDown",Ye),qt.set("Upload",Vt),qt.set("Divider",G);const{t:Jt}=xe();function Kt(e){return e.includes("Input")||e.includes("Complete")?Jt("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?Jt("common.chooseText"):""}function Xt(e,t){return e&&["Input","InputPassword","InputSearch","InputTextArea"].includes(e)&&t&&Ne(t)?`${t}`:t}const Qt=[...["DatePicker","MonthPicker","WeekPicker","TimePicker"],"RangePicker"];function Yt(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!fe(e)}var Zt=c({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:t}){const{t:n}=xe(),{schema:a,formProps:o}=te(e),l=(i=a,u=o,m((()=>{const e=f(i),{labelCol:t={},wrapperCol:n={}}=e.itemProps||{},{labelWidth:a,disabledLabelWidth:o}=e,{labelWidth:l,labelCol:s,wrapperCol:c}=f(u);if(!l&&!a&&!s||o)return t.style={textAlign:"left"},{labelCol:t,wrapperCol:n};let d=a||l;const p=r(r({},s),t),m=r(r({},c),n);return d&&(d=Ne(d)?`${d}px`:d),{labelCol:r({style:{width:d}},p),wrapperCol:r({style:{width:`calc(100% - ${d})`}},m)}})));var i,u;const c=m((()=>{const{allDefaultValues:t,formModel:n,schema:a}=e,{mergeDynamicData:o}=e.formProps;return{field:a.field,model:n,values:r(r(r({},o),t),n),schema:a}})),d=m((()=>{var t;const{schema:n,tableAction:a,formModel:o,formActionType:l}=e;let{componentProps:i={}}=n;return Se(i)&&(i=null!=(t=i({schema:n,tableAction:a,formModel:o,formActionType:l}))?t:{}),"Divider"===n.component&&(i=Object.assign({type:"horizontal"},i,{orientation:"left",plain:!0})),i})),p=m((()=>{const{disabled:t}=e.formProps,{dynamicDisabled:n}=e.schema,{disabled:a=!1}=f(d);let o=!!t||a;return Ue(n)&&(o=n),Se(n)&&(o=n(f(c))),o}));function g(){const{show:t,ifShow:n}=e.schema,{showAdvancedButton:a}=e.formProps,o=!a||(!Ue(e.schema.isAdvanced)||e.schema.isAdvanced);let l=!0,i=!0;return Ue(t)&&(l=t),Ue(n)&&(i=n),Se(t)&&(l=t(f(c))),Se(n)&&(i=n(f(c))),l=l&&o,{isShow:l,isIfShow:i}}function h(){var t;const{rules:a=[],component:o,rulesMessageJoinLabel:l,label:i,dynamicRules:r,required:s}=e.schema;if(Se(r))return r(f(c));let u=he(a);const{rulesMessageJoinLabel:p}=e.formProps,m=Reflect.has(e.schema,"rulesMessageJoinLabel")?l:p,h=Kt(o)+`${m?i:""}`;const v=Se(s)?s(f(c)):s;u&&0!==u.length||!v||(u=[{required:v,validator:function(e,t){const n=e.message||h;return void 0===t||ze(t)||Array.isArray(t)&&0===t.length||"string"==typeof t&&""===t.trim()||"object"==typeof t&&Reflect.has(t,"checked")&&Reflect.has(t,"halfChecked")&&Array.isArray(t.checked)&&Array.isArray(t.halfChecked)&&0===t.checked.length&&0===t.halfChecked.length?Promise.reject(n):Promise.resolve()}}]);const b=u.findIndex((e=>Reflect.has(e,"required")&&!Reflect.has(e,"validator")));if(-1!==b){const e=u[b],{isShow:n}=g();if(n||(e.required=!1),o){Reflect.has(e,"type")||(e.type="InputNumber"===o?"number":"string"),e.message=e.message||h,(o.includes("Input")||o.includes("Textarea"))&&(e.whitespace=!0);!function(e,t,n){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(t)?e.type=n?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(t)?e.type="array":["InputNumber"].includes(t)&&(e.type="number")}(e,o,null==(t=f(d))?void 0:t.valueFormat)}}const y=u.findIndex((e=>e.max));return-1===y||u[y].validator||(u[y].message=u[y].message||n("component.form.maxTip",[u[y].max])),u}function v(){const{label:t,helpMessage:n,helpComponentProps:a,subLabel:o}=e.schema,l=o?T("span",null,[t,R(" "),T("span",{class:"text-secondary"},[o])]):t,i=Se(n)?n(f(c)):n;return!i||Array.isArray(i)&&0===i.length?l:T("span",null,[l,T($e,O({placement:"top",class:"mx-1",text:i},a),null)])}function b(){const{itemProps:n,slot:a,render:o,field:i,suffix:u,component:m}=e.schema,{labelCol:g,wrapperCol:b}=f(l),{colon:y}=e.formProps;if("Divider"===m){let e;return T(me,{span:24},{default:()=>[T(G,f(d),Yt(e=v())?e:{default:()=>[e]})]})}{const l=()=>a?_e(t,a,f(c)):o?o(f(c)):function(){var t;const{renderComponentContent:n,component:a,field:o,changeEvent:l="change",valueField:i}=e.schema,u=a&&["Switch","Checkbox"].includes(a),m=`on${ve(l)}`,g={[m]:(...t)=>{const[n]=t;y[m]&&y[m](...t);const a=n?n.target:null,l=a?u?a.checked:a.value:n;e.setFormModel(o,l)}},h=qt.get(a),{autoSetPlaceHolder:v,size:b}=e.formProps,y=s(r({allowClear:!0,getPopupContainer:e=>e.parentNode,size:b},f(d)),{disabled:f(p)});!y.disabled&&v&&"RangePicker"!==a&&a&&(y.placeholder=(null==(t=f(d))?void 0:t.placeholder)||Kt(a)),y.codeField=o,y.formValues=f(c);const C={[i||(u?"checked":"value")]:e.formModel[o]},w=r(r(r({},y),g),C);if(!n)return T(h,w,null);const x=Se(n)?r({},n(f(c))):{default:()=>n};return T(h,w,Yt(x)?x:{default:()=>[x]})}(),m=!!u,C=Se(u)?u(f(c)):u;return T(ge.Item,O({name:i,colon:y,class:{"suffix-item":m}},n,{label:v(),rules:h(),labelCol:g,wrapperCol:b}),{default:()=>[T("div",{style:"display:flex"},[T("div",{style:"flex:1;"},[l()]),m&&T("span",{class:"suffix"},[C])])]})}}return()=>{let n;const{colProps:a={},colSlot:o,renderColContent:l,component:i}=e.schema;if(!qt.has(i))return null;const{baseColProps:s={}}=e.formProps,u=r(r({},s),a),{isIfShow:d,isShow:p}=g(),m=f(c);return d&&de(T(me,u,Yt(n=o?_e(t,o,m):l?l(m):b())?n:{default:()=>[n]}),[[pe,p]])}}});const en=Symbol();function tn(e){return Ge(e,en)}var nn=Ae(c({name:"BasicFormAction",components:{FormItem:ge.Item,Button:We,BasicArrow:He,[me.name]:me},props:{showActionButtonGroup:Ce.bool.def(!0),showResetButton:Ce.bool.def(!0),showSubmitButton:Ce.bool.def(!0),showAdvancedButton:Ce.bool.def(!0),resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:Ce.number.def(6),isAdvanced:Ce.bool,hideAdvanceBtn:Ce.bool},emits:["toggle-advanced"],setup(e,{emit:t}){const{t:n}=xe(),a=m((()=>{const{showAdvancedButton:t,actionSpan:n,actionColOptions:a}=e,o=24-n;return r(r({style:{textAlign:"right"},span:t?6:4},t?{span:o<6?24:o}:{}),a)})),o=m((()=>Object.assign({text:n("common.resetText")},e.resetButtonOptions))),l=m((()=>Object.assign({text:n("common.queryText")},e.submitButtonOptions)));return r({t:n,actionColOpt:a,getResetBtnOptions:o,getSubmitBtnOptions:l,toggleAdvanced:function(){t("toggle-advanced")}},Ee(en))}}),[["render",function(e,t,n,a,o,l){const i=y("Button"),r=y("BasicArrow"),s=y("FormItem"),u=y("a-col");return e.showActionButtonGroup?(C(),w(u,U(O({key:0},e.actionColOpt)),{default:x((()=>[L("div",{style:be([{width:"100%"},{textAlign:e.actionColOpt.style.textAlign}])},[T(s,null,{default:x((()=>[j(e.$slots,"resetBefore"),e.showResetButton?(C(),w(i,O({key:0,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:x((()=>[R(P(e.getResetBtnOptions.text),1)])),_:1},16,["onClick"])):q("",!0),j(e.$slots,"submitBefore"),e.showSubmitButton?(C(),w(i,O({key:1,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:x((()=>[R(P(e.getSubmitBtnOptions.text),1)])),_:1},16,["onClick"])):q("",!0),j(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(C(),w(i,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:x((()=>[R(P(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),T(r,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])])),_:1},8,["onClick"])):q("",!0),j(e.$slots,"advanceAfter")])),_:3})],4)])),_:3},16)):q("",!0)}]]);export{tt as A,Ft as D,kt as F,Bt as I,At as P,xt as R,jt as T,Zt as _,St as a,nt as b,It as c,$t as d,Pt as e,Ot as f,Rt as g,mt as h,Xt as i,Qt as j,nn as k,tn as l,ft as u};
