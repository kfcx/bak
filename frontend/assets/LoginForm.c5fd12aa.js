import{A as e,r as a,a0 as s,B as l,a1 as t,a5 as n,H as o,a4 as r,a_ as c,ap as i,P as u,k as d,u as p,D as m,F as f,G as g,w as y,a$ as v,ad as x,J as h,aT as _,b0 as b,b1 as S,b2 as k,b3 as C,b4 as w,b5 as z,K as I,b6 as T,aa as j,b7 as E,b8 as F}from"./vendor.84d2d683.js";/* empty css              */import{u as R}from"./useFormItem.75e32247.js";/* empty css               *//* empty css               */import{a as L,_ as P,w as $,b as A,e as M,f as D}from"./index.2956b203.js";import{u as U,a as B,L as G,_ as K,b as O}from"./LoginFormTitle.57d17caa.js";const q=e({name:"CaptchaInput",inheritAttrs:!1,props:{value:{type:String},size:{type:String,validator:e=>["default","large","small"].includes(e)},captchaSrc:{type:String,default:""}},setup(e){const s=a("");s.value=e.captchaSrc;const{prefixCls:l}=L("captcha-input"),[t]=R(e);return{prefixCls:l,state:t,handleClick:()=>s.value=e.captchaSrc+"?r="+Math.random(),src:s}}}),N=["src"];const H=$(P(q,[["render",function(e,a,c,i,u,d){const p=s("a-input");return l(),t(p,r(e.$attrs,{class:e.prefixCls,size:e.size,value:e.state}),{addonAfter:n((()=>[o("img",{src:e.src,onClick:a[0]||(a[0]=(...a)=>e.handleClick&&e.handleClick(...a)),alt:"验证码"},null,8,N)])),_:1},16,["class","size","value"])}]])),J=e({setup(e){const s=E,t=F,r=c.Item,R=i.Password,{t:P}=A(),{notification:$,createErrorModal:q}=D(),{prefixCls:N}=L("login"),J=M(),{setLoginState:Q,getLoginState:W}=U(),{getFormRules:V}=B(),X=a(),Y=a(!1),Z=a(!1),ee=a("/api/v1/user/captcha"),ae=u({account:"admin",password:"a12345678",code:""}),{validForm:se}=O(X),le=d((()=>p(W)===G.LOGIN));function te(){return e=this,a=null,s=function*(){const e=yield se();if(e)try{Y.value=!0;const a=yield J.login({password:e.password,username:e.account,code:e.code,mode:"none"});a&&$.success({message:P("sys.login.loginSuccessTitle"),description:`${P("sys.login.loginSuccessDesc")}: ${a.nickname}`,duration:3})}catch(a){q({title:P("sys.api.errorTip"),content:a.message||P("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${N}`)||document.body})}finally{Y.value=!1}},new Promise(((l,t)=>{var n=e=>{try{r(s.next(e))}catch(a){t(a)}},o=e=>{try{r(s.throw(e))}catch(a){t(a)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,o);r((s=s.apply(e,a)).next())}));var e,a,s}return(e,a)=>(l(),m(j,null,[f(y(K,{class:"enter-x"},null,512),[[g,p(le)]]),f(y(p(c),{class:"p-4 enter-x",model:p(ae),rules:p(V),ref:(e,a)=>{a.formRef=e,X.value=e},onKeypress:T(te,["enter"])},{default:n((()=>[y(p(r),{name:"account",class:"enter-x"},{default:n((()=>[y(p(i),{size:"large",value:p(ae).account,"onUpdate:value":a[0]||(a[0]=e=>p(ae).account=e),placeholder:p(P)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),y(p(r),{name:"password",class:"enter-x"},{default:n((()=>[y(p(R),{size:"large",visibilityToggle:"",value:p(ae).password,"onUpdate:value":a[1]||(a[1]=e=>p(ae).password=e),placeholder:p(P)("sys.login.password")},null,8,["value","placeholder"])])),_:1}),y(p(r),{name:"code",class:"enter-x"},{default:n((()=>[y(p(H),{size:"large",value:p(ae).code,"onUpdate:value":a[2]||(a[2]=e=>p(ae).code=e),captchaSrc:ee.value,placeholder:"请输入验证码"},null,8,["value","captchaSrc"])])),_:1}),y(p(t),{class:"enter-x"},{default:n((()=>[y(p(s),{span:12},{default:n((()=>[y(p(r),null,{default:n((()=>[y(p(v),{checked:Z.value,"onUpdate:checked":a[3]||(a[3]=e=>Z.value=e),size:"small"},{default:n((()=>[x(h(p(P)("sys.login.rememberMe")),1)])),_:1},8,["checked"])])),_:1})])),_:1}),y(p(s),{span:12},{default:n((()=>[y(p(r),{style:{"text-align":"right"}},{default:n((()=>[y(p(_),{type:"reset",size:"small",onClick:a[4]||(a[4]=e=>p(Q)(p(G).RESET_PASSWORD))},{default:n((()=>[x(h(p(P)("sys.login.forgetPassword")),1)])),_:1})])),_:1})])),_:1})])),_:1}),y(p(r),{class:"enter-x"},{default:n((()=>[y(p(_),{type:"submit",size:"large",block:"",onClick:te,loading:Y.value},{default:n((()=>[x(h(p(P)("sys.login.loginButton")),1)])),_:1},8,["loading"])])),_:1}),y(p(t),{class:"enter-x"},{default:n((()=>[y(p(s),{md:8,xs:24},{default:n((()=>[y(p(_),{block:"",onClick:a[5]||(a[5]=e=>p(Q)(p(G).EMAIL))},{default:n((()=>[x(h(p(P)("sys.login.emailSignInFormTitle")),1)])),_:1})])),_:1}),y(p(s),{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:n((()=>[y(p(_),{block:"",onClick:a[6]||(a[6]=e=>p(Q)(p(G).QR_CODE))},{default:n((()=>[x(h(p(P)("sys.login.qrSignInFormTitle")),1)])),_:1})])),_:1}),y(p(s),{md:7,xs:24},{default:n((()=>[y(p(_),{block:"",onClick:a[7]||(a[7]=e=>p(Q)(p(G).REGISTER))},{default:n((()=>[x(h(p(P)("sys.login.registerButton")),1)])),_:1})])),_:1})])),_:1}),y(p(b),{class:"enter-x"},{default:n((()=>[x(h(p(P)("sys.login.otherSignIn")),1)])),_:1}),o("div",{class:I(["flex justify-evenly enter-x",`${p(N)}-sign-in-way`])},[y(p(S)),y(p(k)),y(p(C)),y(p(w)),y(p(z))],2)])),_:1},8,["model","rules","onKeypress"]),[[g,p(le)]])],64))}});export{J as default};
