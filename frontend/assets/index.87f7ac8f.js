import{B as e,u as t}from"./useTable.5d27771c.js";import{T as o}from"./FormAction.9732afc1.js";import{b as n,d as i}from"./account.d0c5cf5d.js";import{b as a}from"./index.a66a0969.js";import{A as s,c as r,s as c}from"./AccountModal.9185d016.js";import{_ as d,ah as l,j as m,ai as u,f as p}from"./index.2956b203.js";import{A as f,P as h,a0 as j,B as b,D as x,w as S,aC as g,a5 as T,ad as w}from"./vendor.84d2d683.js";/* empty css              */import"./useForm.07071468.js";import"./useFormItem.75e32247.js";/* empty css               */import"./index.7a603658.js";/* empty css               *//* empty css               */import"./useWindowSizeFn.a02e5cb7.js";import"./useContentViewHeight.fee9e617.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               */import"./useSortable.817b3359.js";/* empty css                *//* empty css                *//* empty css                */import"./download.eecfd47d.js";import"./index.8bcb94a9.js";import"./index.1350911d.js";import"./role.334f6c1b.js";const v=f({name:"AccountManagement",components:{AButton:l,BasicTable:e,AccountModal:s,TableAction:o},setup(){const{createMessage:e}=p(),o=m(),{hasPermission:s}=u(),[d,{openModal:l}]=a(),f=h({}),[j,{reload:b,updateTableDataRecord:x}]=t({title:"账号列表",api:n,rowKey:"id",columns:r,showIndexColumn:!1,formConfig:{labelWidth:120,schemas:c,autoSubmitOnEnter:!0,autoAdvancedLine:1,fieldMapToTime:[["createTime",["createTimeStart","createTimeEnd"],"YYYY-MM-DD HH:mm:ss"]]},useSearchForm:!0,showTableSetting:!0,tableSetting:{fullScreen:!0},bordered:!0,canResize:!1,handleSearchInfoFn:e=>e,actionColumn:{width:150,title:"操作",dataIndex:"action",slots:{customRender:"action"}}});return{hasPermission:s,registerTable:j,registerModal:d,handleSelect:function(e=""){f.deptId=e,b()},handleCreate:function(){l(!0,{isUpdate:!1})},handleEdit:function(e){l(!0,{record:e,isUpdate:!0})},handleDelete:function(t){return o=this,n=null,a=function*(){yield i(t.id).then((()=>{e.success("已成功删除账号")})).catch((()=>{e.error("删除账号失败")})),yield b()},new Promise(((e,t)=>{var i=e=>{try{r(a.next(e))}catch(o){t(o)}},s=e=>{try{r(a.throw(e))}catch(o){t(o)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,s);r((a=a.apply(o,n)).next())}));var o,n,a},handleSuccess:function({isUpdate:e,values:t}){if(e){x(t.id,t)}else b()},handleView:function(e){o("/system/account/"+e.id)},searchInfo:f}}}),A=w("新增账号");var C=d(v,[["render",function(e,t,o,n,i,a){const s=j("a-button"),r=j("TableAction"),c=j("BasicTable"),d=j("AccountModal");return b(),x("div",null,[S(c,{onRegister:e.registerTable,searchInfo:e.searchInfo},g({action:T((({record:t})=>[S(r,{actions:[{icon:"clarity:note-edit-line",tooltip:"编辑用户资料",onClick:e.handleEdit.bind(null,t),ifShow:()=>e.hasPermission(["account_update"])},{icon:"ant-design:delete-outlined",color:"error",tooltip:"删除此账号",popConfirm:{title:"是否确认删除",placement:"left",confirm:e.handleDelete.bind(null,t)},ifShow:()=>e.hasPermission(["account_delete"])}]},null,8,["actions"])])),_:2},[e.hasPermission(["account_add"])?{name:"toolbar",fn:T((()=>[S(s,{type:"primary",onClick:e.handleCreate},{default:T((()=>[A])),_:1},8,["onClick"])]))}:void 0]),1032,["onRegister","searchInfo"]),S(d,{onRegister:e.registerModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])])}]]);export{C as default};
